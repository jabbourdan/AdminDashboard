@model IEnumerable<UI_USM_MVC.Models.Services>

@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewBag.Title = "Catalog";
}


@section Styles {
    <link href="~/CSS/Catalog/Catalog.css" rel="stylesheet" />
}

<div class="header">
    <div class="left">
        <div class="tab-buttons">
            <button class="tab-button active" onclick="showTab('Service_menu', event)">Service menu</button>
            <button class="tab-button" onclick="showTab('Package', event)">Package</button>
            <button class="tab-button" onclick="showTab('Membership', event)">Memberships (Coming soon)</button>
        </div>
    </div>
</div>

<div id="Service_menu" class="tab-content active">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h1 class="h4">Service list <span class="badge bg-secondary" id="servicesCount"></span></h1>
        <div>
            <button class="btn btn-outline-secondary me-2">Options</button>
            <button class="btn btn-dark" onclick="location.href='@Url.Action("AddNewService", "Catalog")'">Add</button>
        </div>
    </div>
    <div class="mb-3 d-flex justify-content-between">
        <div class="input-group" style="width: 70%;">
            <span class="input-group-text bg-white"><i class="bi bi-search"></i></span>
            <input type="text" class="form-control" id="serviceSearchInput" placeholder="Search by service name">
        </div>
        <button class="btn btn-outline-secondary">Filters</button>
        <select class="form-select" style="width: 20%;">
            <option>Created at (newest first)</option>
        </select>
    </div>
    <table class="table">
        <thead>
            <tr>
                <th><input type="checkbox" id="serviceSelectAllCheckbox"></th>
                <th>Service name</th>
                <th>Category</th>
                <th>Service Color</th>
                <th>Description</th>
                <th>Duration</th>
                <th>Price</th>
                <th>Sale</th>
            </tr>
        </thead>
        <tbody id="serviceTableBody">
            @foreach (var service in Model.Where(x => x.Package == false))
            {
                <tr data-service-id="@service.ServicesId">
                    <td><input type="checkbox" /></td>
                    <td>@service.ServiceName</td>
                    <td>@service.Category</td>
                    <td>
                        <div class="color-box" style="background-color: @service.ServiceColor;"></div>
                    </td>

                    <td>@service.Descriptions</td>
                    <td>@service.Duration</td>
                    <td>@service.Price</td>
                    <td>
                        @(
                            double.TryParse(service.Sale, out double saleValue) && saleValue > 0
                            ? $"{saleValue} %"
                            : "No sale"
                            )
                    </td>
                    <td>
                        <div class="dropdown">
                            <button class="custom-dropdown-btn" onclick="toggleOptions(this)" style="position: relative;">
                                <span class="three-dots">•••</span>
                            </button>
                            <div class="dropdown-options"
                                style="display: none; position: absolute; background-color: white; border: 1px solid #ccc; padding: 5px; border-radius: 4px; z-index: 1000;">
                                <button class="edit-service" onclick="editService(@service.ServicesId)">Edit</button>
                                <button class="delete-service" onclick="deleteService(@service.ServicesId)">Delete</button>
                            </div>
                        </div>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>

<div id="Package" class="tab-content">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h1 class="h4">Package list <span class="badge bg-secondary" id="packageCount"></span></h1>
        <div>
            <button class="btn btn-outline-secondary me-2">Options</button>
            <button class="btn btn-dark" onclick="location.href='@Url.Action("AddNewPackage", "Catalog")'">Add</button>
        </div>
    </div>
    <div class="mb-3 d-flex justify-content-between">
        <div class="input-group" style="width: 70%;">
            <span class="input-group-text bg-white"><i class="bi bi-search"></i></span>
            <input type="text" class="form-control" id="SearchInput" placeholder="Search by package name">
        </div>
        <button class="btn btn-outline-secondary">Filters</button>
        <select class="form-select" style="width: 20%;">
            <option>Created at (newest first)</option>
        </select>
    </div>
    <table class="table">
        <thead>
            <tr>
                <th><input type="checkbox" id="packageSelectAllCheckbox"></th>
                <th>Package name</th>
                <th>Category</th>
                <th>Package Color</th>
                <th>Services</th>
                <th>Description</th>
                <th>Duration</th>
                <th>Price</th>
                <th>Price</th>
            </tr>
        </thead>
        <tbody id="packageTableBody">
            @foreach (var service in Model.Where(x => x.Package == true))
            {
                <tr data-service-id="@service.ServicesId">
                    <td><input type="checkbox" /></td>
                    <td>@service.ServiceName</td>
                    <td>@service.Category</td>
                    <td>
    <div class="color-box" style="background-color: @service.ServiceColor;"></div>
</td>

                    <td>@service.ConnectedServiceIds</td>
                    <td>@service.Descriptions</td>
                    <td>@service.Duration</td>
                    <td>@service.Price</td>
                    <td>
                        @(
                            double.TryParse(service.Sale, out double saleValue) && saleValue > 0
                            ? $"{saleValue} %"
                            : "No sale"
                            )
                    </td>
                    <td>
                        <div class="dropdown">
                            <button class="custom-dropdown-btn" onclick="toggleOptions(this)" style="position: relative;">
                                <span class="three-dots">•••</span>
                            </button>
                            <div class="dropdown-options"
                                style="display: none; position: absolute; background-color: white; border: 1px solid #ccc; padding: 5px; border-radius: 4px; z-index: 1000;">
                                <button class="edit-service" onclick="editService(@service.ServicesId)">Edit</button>
                                <button class="delete-service" onclick="deleteService(@service.ServicesId)">Delete</button>
                            </div>
                        </div>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>



@section Scripts {
    <script src="~/js/Catalog/CatalogJS.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
    

}
